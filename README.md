# Common Workflow Language Website 2.0

<!-- MarkdownTOC -->

* [Editing the Site](#editing-the-site)
  * [Config Files & Local Development](#config-files--local-development)
* [Directory Structure](#directory-structure)
* [Video Player - Plyr](#video-player---plyr)
  * [Plyr API options](#plyr-api-options)
* [Twitter Feed](#twitter-feed)
* [SEO Tags](#seo-tags)

<!-- /MarkdownTOC -->

This is the repo for the [CWL Website](https://commonwl.org).

* GitHub Repo: https://github.com/common-workflow-language/
* Staging Branch: https://github.com/common-workflow-language/cwl-website/tree/add-jekyll-site
* Staging Site: https://www.commonwl.org/cwl-staging/

<a id="editing-the-site"></a>
## Editing the Site

1. On `main`, run a `git fetch --all` and pull in any changes.
2. Switch to `add-jekyll-site` and then merge the changes via `git merge main`
3. Make sure you're making your changes on the `add-jekyll-site` (or your own branch, which you can merge to `add-jekyll-site`).
4. Push to `add-jekyll-site` and then check that everything looks good. 
5. If all is well, head over to the [main repo](https://github.com/common-workflow-language/) and create a Pull Request.

<a id="config-files--local-development"></a>
### Config Files & Local Development

The site uses `_config.yml` for the production site, and `_config_staging.yml` for the staging site (which inherits, then overrides `_config.yml`). For ease of local development, you may wish to use a 3rd config file, e.g. `_config_local.yml`. If so, please don't add it to the repo.

My `_config_local.yml` currently looks like this:

```yaml
title: CWL Local Site
url: "cwl.test"
baseurl: ""
port: 80
```

The command for this is: `bundle exec jekyll serve --config "_config.yml,_config_local.yml"`. (Note the lack of spaces between the two config files).

One quirk of Jekyll local development, is that it will set the hostname to `localhost`, ignoring the `url` variable specified in the config file. To override this, you can add the `--host` flag, e.g. `bundle exec jekyll serve --host cwl.test --config "_config.yml,_config_local.yml"`


<a id="directory-structure"></a>
## Directory Structure

As of March 11 2021, the directory structure looks as follows

```sh
├── _data
├── _includes
│   └── home
├── _layouts
├── _sass
│   ├── bootstrap
│   │   ├── mixins
│   │   ├── utilities
│   │   └── vendor
│   └── partials
├── _subtitles
├── assets
│   ├── css
│   ├── img
│   ├── js
│   ├── plyr
│   └── video
│       └── subtitles
└── favicon
```

`_data` - includes the data for the two nav menus
`_includes` - the templates for the site sections. Each homepage section has its own sub-template under `_includes/home`
`_sass` - the scss styles for the entire site. The `bootstrap` should be left alone.
`assets` - contains the various images, scripts, video subtitles, etc.
`favicon` - contains the favicon files for various browsers, generated by [RealFaviconGenerator](https://realfavicongenerator.net/)

<a id="video-player---plyr"></a>
## Video Player - Plyr

The video player is built using [Plyr](https://github.com/sampotts/plyr). The scripts for it are found in `assets/plyr`, and shouldn't really be touched.

The HTML and JS that renders the video player is found in `_includes/home/video-player.html`. The additional styles for the video player are in `_sass/partials/home.scss`.

Subtitles are found in `assets/video/subtitles`, and were extracted from the original YouTube video via [DownSub](https://downsub.com/), and converted to .vtt via [Subtitle Tools - Convert Subtitles to Vtt](https://subtitletools.com/convert-to-vtt-online/). 
* Video players use the `srclang` attribute to indicate the language to the browser. A list of srclang codes can be found here: https://www.footprintaddons.com/my-account/articles-news/282-language-codes-subtitle-tracks

<a id="plyr-api-options"></a>
### Plyr API options

```js
controls: [
    'play-large', // The large play button in the center
    'restart', // Restart playback
    'rewind', // Rewind by the seek time (default 10 seconds)
    'play', // Play/pause playback
    'fast-forward', // Fast forward by the seek time (default 10 seconds)
    'progress', // The progress bar and scrubber for playback and buffering
    'current-time', // The current time of playback
    'duration', // The full duration of the media
    'mute', // Toggle mute
    'volume', // Volume control
    'captions', // Toggle captions
    'settings', // Settings menu
    'pip', // Picture-in-picture (currently Safari only)
    'airplay', // Airplay (currently Safari only)
    'download', // Show a download button with a link to either the current source or a custom URL you specify in your options
    'fullscreen', // Toggle fullscreen
];
```

<a id="twitter-feed"></a>
## Twitter Feed

The twitter feed code is found in `_includes/twitter_feed.html`. It includes the `data-dnt` attribute, so as not to track user data. Despite this, the feed won't render on many mobile devices, due to default privacy settings in Chrome and Firefox. In that case the users will simply see "See Tweets by @commonwl", in place of the feed itself.

<a id="seo-tags"></a>
## SEO Tags

The SEO meta for the site is auto-generated via [jekyll-seo-tag](https://github.com/jekyll/jekyll-seo-tag/). See [Jekyll SEO Tag - Usage](https://github.com/jekyll/jekyll-seo-tag/blob/master/docs/usage.md) for reference.
